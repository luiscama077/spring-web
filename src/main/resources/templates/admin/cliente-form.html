<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head th:replace="~{fragments/header :: head}"></head>
<body class="bg-gray-900 min-h-screen font-sans text-gray-300">
    
    <!-- Navbar -->
    <div th:replace="~{fragments/navbar :: navbar-admin}"></div>

    <div class="flex">
        <!-- Sidebar -->
        <div th:replace="~{fragments/navbar :: sidebar-admin(seccion='clientes'  )}"></div>

        <!-- Overlay -->
        <div th:replace="~{fragments/navbar :: sidebar-overlay}"></div>

        <!-- Main Content -->
        <main class="flex-1 p-4 sm:p-6 lg:p-8">
            <div class="max-w-4xl mx-auto">
                
                <!-- Header -->
                <div class="mb-8 text-center sm:text-left">
                    <h2 class="text-3xl font-bold text-white" 
                        th:text="${accion == 'nuevo' ? 'Registrar Nuevo Cliente' : 'Editar Cliente'}">
                        Título del Formulario
                    </h2>
                    <p class="text-gray-400 mt-1">Complete la información para gestionar el acceso y los datos del cliente.</p>
                </div>

                <!-- Formulario -->
                <div class="bg-gray-800/50 rounded-xl p-6 sm:p-8 border border-gray-700/50 backdrop-blur-sm">
                    <form th:action="${accion == 'nuevo' ? '/admin/clientes/guardar' : '/admin/clientes/actualizar'}" 
                          th:object="${cliente}" 
                          method="post"
                          class="space-y-8">
                        
                        <!-- IDs ocultos para edición -->
                        <input type="hidden" th:field="*{id}" th:if="${accion == 'editar'}">
                        <input type="hidden" th:field="*{usuario.id}" th:if="${accion == 'editar'}">

                        <!-- Sección: Datos de Acceso -->
                        <fieldset class="space-y-6">
                            <legend class="text-xl font-semibold text-white pb-4 border-b border-gray-700/50">Datos de Acceso</legend>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Username -->
                                <div>
                                    <label for="username" class="block text-sm font-medium text-gray-300 mb-2">Nombre de Usuario *</label>
                                    <div class="relative">
                                        <i data-lucide="at-sign" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                        <input type="text" id="username" th:field="*{usuario.username}" required placeholder="Ej: mjlopez" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                    </div>
                                </div>
                                <!-- Email -->
                                <div>
                                    <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email *</label>
                                    <div class="relative">
                                        <i data-lucide="mail" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                        <input type="email" id="email" th:field="*{usuario.email}" required placeholder="ejemplo@mail.com" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                    </div>
                                </div>
                            </div>
                            <!-- Password -->
                            <div>
                                <label for="password" class="block text-sm font-medium text-gray-300 mb-2">
                                    Contraseña <span th:if="${accion == 'nuevo'}">*</span>
                                </label>
                                <div class="relative">
                                    <i data-lucide="lock" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                    <input type="password" id="password" th:field="*{usuario.password}" th:required="${accion == 'nuevo'}" placeholder="Mínimo 6 caracteres" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                </div>
                                <p th:if="${accion == 'editar'}" class="text-gray-500 text-xs mt-2">Dejar el campo de contraseña vacío para no realizar cambios.</p>
                            </div>
                        </fieldset>

                        <!-- Sección: Datos Personales -->
                        <fieldset class="space-y-6">
                            <legend class="text-xl font-semibold text-white pb-4 border-b border-gray-700/50">Datos Personales</legend>

                            <!-- Nombre Completo -->
                            <div>
                                <label for="nombreCompleto" class="block text-sm font-medium text-gray-300 mb-2">Nombre Completo *</label>
                                <div class="relative">
                                    <i data-lucide="user" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                    <input type="text" id="nombreCompleto" th:field="*{nombreCompleto}" required placeholder="Ej: María López Rojas" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                </div>
                            </div>

                            <!-- Fila: DNI y Teléfono -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="dni" class="block text-sm font-medium text-gray-300 mb-2">DNI</label>
                                    <div class="relative">
                                        <i data-lucide="scan-line" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                        <input type="text" id="dni" th:field="*{dni}" placeholder="00000000" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                    </div>
                                </div>
                                <div>
                                    <label for="telefono" class="block text-sm font-medium text-gray-300 mb-2">Teléfono</label>
                                    <div class="relative">
                                        <i data-lucide="phone" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                        <input type="text" id="telefono" th:field="*{telefono}" placeholder="999999999" class="w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                    </div>
                                </div>
                            </div>

                            <!-- Fila: Género y Fecha Nacimiento -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="genero" class="block text-sm font-medium text-gray-300 mb-2">Género</label>
                                    <div class="relative">
                                        <i data-lucide="users" class="absolute left-3 top-1/2 -translate-y-1/2 size-5 text-gray-400"></i>
                                        <select id="genero" th:field="*{genero}" class="w-full appearance-none pl-10 pr-8 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                            <option th:each="gen : ${generos}" th:value="${gen}" th:text="${gen}">Género</option>
                                        </select>
                                        <i data-lucide="chevron-down" class="absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-400 pointer-events-none"></i>
                                    </div>
                                </div>
                                <div>
                                    <label for="fechaNacimiento" class="block text-sm font-medium text-gray-300 mb-2">Fecha de Nacimiento</label>
                                    <input type="date" id="fechaNacimiento" name="fechaNacimiento"
                                           th:value="${cliente.fechaNacimiento != null ? #temporals.format(cliente.fechaNacimiento, 'yyyy-MM-dd') : ''}" 
                                           class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                                </div>
                            </div>

                            <!-- Direcciones -->
                            <div>
                                <label for="direccionPrincipal" class="block text-sm font-medium text-gray-300 mb-2">Dirección Principal</label>
                                <textarea id="direccionPrincipal" th:field="*{direccionPrincipal}" rows="2" placeholder="Ej: Jr. Los Olivos 789, Arequipa" class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all resize-none"></textarea>
                            </div>
                            <div>
                                <label for="direccionSecundaria" class="block text-sm font-medium text-gray-300 mb-2">Dirección Secundaria <span class="text-gray-500 text-xs">(Opcional)</span></label>
                                <textarea id="direccionSecundaria" th:field="*{direccionSecundaria}" rows="2" placeholder="Ej: Oficina, trabajo, etc." class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all resize-none"></textarea>
                            </div>
                        </fieldset>

                        <!-- Botones -->
                        <div class="flex flex-col-reverse sm:flex-row sm:justify-end gap-4 pt-8 border-t border-gray-700/50">
                            <a href="/admin/clientes" class="w-full sm:w-auto text-center bg-gray-700/50 hover:bg-gray-600/50 text-white px-6 py-3 rounded-lg transition-colors">
                                Cancelar
                            </a>
                            <button type="submit" class="w-full sm:w-auto inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors font-semibold shadow-lg shadow-blue-600/20">
                                <i data-lucide="save" class="size-5"></i>
                                Guardar Cliente
                            </button>
                        </div>
                    </form>
                </div>

            </div>
        </main>
    </div>

    <!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>

    <!-- Scripts del sidebar-->
    <div th:replace="~{fragments/navbar :: sidebar-scripts}"></div>
</body>
</html>
