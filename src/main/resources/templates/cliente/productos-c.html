<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head th:replace="~{fragments/header :: head}"></head>
<body class="bg-gray-900 min-h-screen font-sans text-gray-300">

    <div th:replace="~{fragments/navbar :: navbar-cliente}"></div>

	<main class="p-4 sm:p-6 lg:p-8">
	    <div class="max-w-7xl mx-auto">
	        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
	            
	            <!-- Columna de Filtros (Izquierda) -->
	            <aside class="lg:col-span-1">
	                <div class="bg-gray-800/50 p-6 rounded-xl border border-gray-700/50 sticky top-24">
	                    <h3 class="text-xl font-semibold text-white mb-4">Filtros</h3>
	                    <!-- Filtro por Categoría -->
	                    <div class="mb-6">
	                        <h4 class="font-semibold mb-2">Categorías</h4>
	                        <ul class="space-y-1 pl-2">
	                            <li><a th:href="@{/cliente/productos}" class="text-gray-300 hover:text-green-400">Todas</a></li>
	                            <li th:each="cat : ${categorias}">
	                                <a th:href="@{/cliente/productos(categoriaId=${cat.id})}" 
	                                   th:text="${cat.nombre}"
	                                   th:classappend="${selectedCategoria == cat.id} ? 'text-green-400 font-bold' : 'text-gray-300 hover:text-green-400'"></a>
	                            </li>
	                        </ul>
	                    </div>
	                    <!-- Ordenar por -->
	                    <div class="mb-6">
	                        <h4 class="font-semibold mb-2">Ordenar por</h4>
	                        <select onchange="window.location.href=this.value" class="w-full bg-gray-800 border border-gray-700 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-green-500">
	                            <option th:value="@{/cliente/productos(sort='fechaCreacion,desc')}" th:selected="${sort == 'fechaCreacion,desc'}">Más Nuevos</option>
	                            <option th:value="@{/cliente/productos(sort='precio,asc')}" th:selected="${sort == 'precio,asc'}">Precio: Menor a Mayor</option>
	                            <option th:value="@{/cliente/productos(sort='precio,desc')}" th:selected="${sort == 'precio,desc'}">Precio: Mayor a Mayor</option>
	                        </select>
	                    </div>
	                    <a th:href="@{/cliente/productos}" class="w-full text-center block bg-gray-700 hover:bg-gray-600 p-2 rounded-md">Limpiar Filtros</a>
	                </div>
	            </aside>

	            <!-- Grid de Productos (Derecha) -->
	            <div class="lg:col-span-3">
					
					<div class="text-center mb-12">
		                <h1 class="text-4xl font-bold text-white">Nuestro Catálogo</h1>
		                <p class="text-lg text-gray-400 mt-2">Encuentra las prendas que definen tu estilo.</p>
		            </div>

		            <!-- Grid de Productos -->
		            <div th:if="${!productosPage.isEmpty( )}" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
		                <!-- Tarjeta de Producto (la misma que en el dashboard) -->
		                <div th:each="producto : ${productosPage.content}" class="bg-gray-800/50 rounded-xl border border-gray-700/50 overflow-hidden group transition-all hover:shadow-2xl hover:border-green-500/50">
		                    <a th:href="@{/cliente/productos/detalle/{id}(id=${producto.id})}" class="block">
		                        <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden">
		                            <img th:src="${producto.imagenUrl ?: '/images/default-product.jpg'}" th:alt="${producto.nombre}" class="w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-300">
		                        </div>
		                        <div class="p-4">
		                            <h3 class="text-lg font-semibold text-white truncate" th:text="${producto.nombre}"></h3>
		                            <p class="text-sm text-gray-400 mb-2" th:text="${producto.marca}"></p>
		                            <p class="text-xl font-bold text-green-400">S/ <span th:text="${#numbers.formatDecimal(producto.precio, 1, 'COMMA', 2, 'POINT')}"></span></p>
		                        </div>
		                    </a>
		                </div>
		            </div>
		            
		            <div th:if="${productosPage.isEmpty()}" class="text-center py-20 text-gray-500">
		                <i data-lucide="frown" class="size-12 mx-auto mb-3"></i>
		                <h3 class="text-lg font-semibold">No hay productos disponibles en este momento.</h3>
		            </div>

		            <!-- Paginación -->
		            <nav th:if="${productosPage.totalPages > 1}" class="mt-12 flex items-center justify-center space-x-2" aria-label="Paginación">
		                <a th:href="@{/cliente/productos(page=${productosPage.number - 1})}"
		                   th:classappend="${productosPage.first} ? 'pointer-events-none opacity-50' : ''"
		                   class="px-4 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition-colors">
		                    Anterior
		                </a>
		                
		                <span th:each="i : ${#numbers.sequence(0, productosPage.totalPages - 1)}">
		                    <a th:href="@{/cliente/productos(page=${i})}"
		                       th:text="${i + 1}"
		                       th:classappend="${i == productosPage.number} ? 'bg-green-600 text-white font-bold' : 'bg-gray-800 hover:bg-gray-700'"
		                       class="px-4 py-2 rounded-md transition-colors">
		                    </a>
		                </span>
		                
		                <a th:href="@{/cliente/productos(page=${productosPage.number + 1})}"
		                   th:classappend="${productosPage.last} ? 'pointer-events-none opacity-50' : ''"
		                   class="px-4 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition-colors">
		                    Siguiente
		                </a>
		            </nav>
					
	            </div>
	        </div>
	    </div>
	</main>

    
    <div th:replace="~{fragments/footer :: footer}"></div>
	<div th:replace="~{fragments/navbar :: cliente-sidebar-scripts}"></div>
</body>
</html>
